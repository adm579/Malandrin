<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Pégale al Camello Cartoon 🐫</title>
<style>
html, body {margin:0; padding:0; height:100%; overflow:hidden; background:black; font-family:'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; color:white;}
#game-container {width:90vw; max-width:500px; height:90vh; max-height:700px; margin:auto; display:flex; flex-direction:column; align-items:center; position:relative; border:1px solid #3498db; border-radius:8px; background:rgba(0,0,0,0.9);}
header {width:95%; text-align:center; padding:12px; font-size:1.5em; font-weight:bold; text-shadow:1px 3px 20px green; border-bottom:1px solid #357ABD; background:rgba(0,0,0,0.7);}
canvas {display:block; margin:10px 0; border-radius:12px; background:rgba(0,0,0,0.1); width:100%; height:100%; flex-grow:1;}
footer {display:flex; justify-content:center; flex-wrap:wrap; gap:8px; padding:10px; border-top:1px solid #2ecc71; background:rgba(0,0,0,0.7); width:100%; position:sticky; bottom:0;}
footer button {font-size:24px; min-font-size:16px; padding:8px 10px; border-radius:8px; border:none; cursor:pointer; transition:0.2s; background:Gainsboro;}
footer button:hover {transform:scale(1.2); background:#00e5ff;}
</style>
</head>
<body>
<div id="game-container">
<header>Pégale A Don Camel 🐫</header>
<canvas id="juego"></canvas>
<footer>
  <button>🌵</button><button>🧰</button><button>🪛</button><button>🔧</button>
  <button>🚲</button><button>🔩</button><button>🔨</button><button>🧹</button>
</footer>
</div>
<script>
// ======= SONIDOS =======
const sonidos = {
  disparo: new Audio("https://freesound.org/data/previews/256/256113_3263906-lq.mp3"),
  golpe: new Audio("https://raw.githubusercontent.com/adm579/Malandrin/f5d17bc0c90596e259ea886c3958c1d96e0eff6e/Cuandole%20pega.mp3"),
  caida: new Audio("https://raw.githubusercontent.com/adm579/Malandrin/bbcb161fdad91cf2d280ae72e776944e74e2b7b2/caida.mp3"),
  subida: new Audio("https://raw.githubusercontent.com/adm579/Malandrin/bbcb161fdad91cf2d280ae72e776944e74e2b7b2/peroregreso.mp3"),
  final: new Audio("https://raw.githubusercontent.com/adm579/Malandrin/f5d17bc0c90596e259ea886c3958c1d96e0eff6e/cuando%20se%20va.mp3")
};
Object.values(sonidos).forEach(s => s.load());
function reproducir(sonido){ const clip = sonido.cloneNode(); clip.play(); }

// ======= CANVAS =======
const canvas=document.getElementById("juego");
const ctx=canvas.getContext("2d");
function ajustarCanvas(){canvas.width=canvas.clientWidth; canvas.height=canvas.clientHeight;}
window.addEventListener("resize", ajustarCanvas);
ajustarCanvas();
let escalaX = () => canvas.width / 450;
let escalaY = () => canvas.height / 590;

// ======= ELEMENTOS =======
const estrellas=Array.from({length:120},()=>({x:Math.random()*canvas.width,y:Math.random()*canvas.height,r:Math.random()*2}));
let camello={x:160,y:100,w:80,h:80,dir:2,brinco:0,estado:"normal",velocidadY:0,visible:true,alpha:1};
let balas=[], balaSeleccionada="🌵";
let mensaje="", mensajeVisible=false, mensajeAnim=0;
let golpes=0, golpesMax=5, juegoTerminado=false;
let particulas=[];

// ======= DIBUJAR =======
function dibujarEstrellas(){ctx.fillStyle="white"; estrellas.forEach(e=>{ctx.beginPath(); ctx.arc(e.x,e.y,e.r*escalaX(),0,Math.PI*2); ctx.fill(); e.y+=0.5*escalaY(); if(e.y>canvas.height)e.y=0;});}
function dibujarCamello(){if(!camello.visible) return; ctx.save(); ctx.globalAlpha=camello.alpha; ctx.font=`${60*escalaX()}px Arial`; ctx.textAlign="center"; let emoji = camello.estado==="subiendo"?"🐫":camello.estado==="cayendo"?"😢":"🐫"; let yOffset=Math.sin(Date.now()/300)*5 + camello.brinco; ctx.fillText(emoji, camello.x*escalaX()+camello.w*escalaX()/2, camello.y*escalaY()+yOffset); ctx.restore();}
function dibujarMensaje(){
  if(mensajeVisible){
    ctx.save();
    ctx.font=`${32*escalaX()}px Arial`;
    ctx.fillStyle=`rgba(255,255,255,${1-mensajeAnim})`;
    ctx.textAlign="center";
    ctx.fillText(mensaje, canvas.width/2, canvas.height/2 - mensajeAnim*80);
    ctx.restore();
    if(mensajeAnim<1) mensajeAnim+=0.02; else mensajeAnim=1;
  }
}
function dibujarBalas(){if(juegoTerminado) return; ctx.font=`${30*escalaX()}px Arial`; ctx.textAlign="center"; balas.forEach(b=>ctx.fillText(b.emoji,b.x*escalaX(),b.y*escalaY()));}
function dibujarParticulas(){ctx.fillStyle="#ff5555"; particulas.forEach(p=>{ctx.beginPath(); ctx.arc(p.x,p.y,p.r,0,Math.PI*2); ctx.fill(); p.x+=p.dx; p.y+=p.dy; p.dy+=0.1;}); particulas=particulas.filter(p=>p.y<canvas.height);}

// ======= MOVIMIENTO =======
function moverCamello(){
  if(!camello.visible) return;
  if(camello.estado==="normal"){camello.x+=camello.dir; camello.brinco=Math.sin(Date.now()/200)*10; if(camello.x<=20||camello.x>=canvas.width-camello.w-20) camello.dir*=-1;}
  else if(camello.estado==="cayendo"){camello.y+=camello.velocidadY; camello.velocidadY+=0.15; if(camello.y>=400){camello.y=400; camello.velocidadY=0.15; if(golpes<golpesMax) iniciarSubida();}}
  else if(camello.estado==="subiendo"){camello.y+=camello.velocidadY; if(camello.y<=100) camello.y=100;}
}
function moverBalas(){if(juegoTerminado) return; balas.forEach(b=>{b.y-=8; verificarGolpe(b);}); balas=balas.filter(b=>b.y>0);}

// ======= COLISIONES Y SONIDOS =======
function verificarGolpe(bala){
  if(camello.estado==="normal" && bala.x>camello.x && bala.x<camello.x+camello.w && bala.y<camello.y+camello.h && bala.y>camello.y-camello.h){
    golpes++;
    reproducir(sonidos.golpe);
    if(golpes>=5){
      juegoTerminado=true; mensaje="Ya me voy al desierto😤"; mensajeVisible=true; mensajeAnim=0;
      reproducir(sonidos.final);
      for(let i=0;i<60;i++){particulas.push({x:camello.x+40,y:camello.y+40,dx:(Math.random()-0.5)*5,dy:(Math.random()-2)*5,r:Math.random()*5+2});}
      let fadeInterval = setInterval(()=>{camello.alpha-=0.03;if(camello.alpha<=0){camello.visible=false;clearInterval(fadeInterval);}},30);
    } else {iniciarCaida();}
  }
}
function iniciarCaida(){camello.estado="cayendo"; camello.velocidadY=1; mensaje="alv"; mensajeVisible=true; mensajeAnim=0; reproducir(sonidos.caida);}
function iniciarSubida(){camello.estado="subiendo"; camello.velocidadY=-1; mensaje="😎"; mensajeVisible=true; mensajeAnim=0; reproducir(sonidos.subida); setTimeout(()=>{camello.estado="normal"; mensajeVisible=false; camello.y=100;},1500);}

// ======= LOOP =======
function loop(){ctx.clearRect(0,0,canvas.width,canvas.height); dibujarEstrellas(); moverCamello(); dibujarCamello(); dibujarBalas(); moverBalas(); dibujarMensaje(); dibujarParticulas(); requestAnimationFrame(loop);}
loop();

// ======= EVENTOS =======
canvas.addEventListener("click", e=>{if(juegoTerminado) return; balas.push({x:e.offsetX/escalaX(),y:canvas.height/escalaY()-30,emoji:balaSeleccionada}); reproducir(sonidos.disparo);});
document.querySelectorAll("footer button").forEach(btn=>{btn.addEventListener("click",()=>{balaSeleccionada=btn.textContent;});});
</script>
</body>
</html>
